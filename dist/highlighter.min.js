"use strict";(()=>{var V=t=>{let n=new DataView(t),e="";for(let s=0;s<n.byteLength;s+=4)e+=n.getUint32(s).toString(16).padStart(8,"0");return e},d=t=>async(n,{outputFormat:e="hex"}={})=>{typeof n=="string"&&(n=new globalThis.TextEncoder().encode(n));let s=await globalThis.crypto.subtle.digest(t,n);return e==="hex"?V(s):s},W=d("SHA-1"),A=d("SHA-256"),z=d("SHA-384"),J=d("SHA-512");var w="jquery-highlighter-highlighted",k=GM_info.script.name+": clear data",M={enabled:!1},H="#FFFD66",I="id",U=function(){return $(this)},R={days:7},j=GM_info.script.version,Q=2,C=Q+"/"+j.split(".")[0],q=(t=>(t.second=t.seconds=1,t.minute=t.minutes=60*t.seconds,t.hour=t.hours=60*t.minutes,t.day=t.days=24*t.hours,t.week=t.weeks=7*t.days,t))({}),h=Symbol(),m=class{delete(n){let e=this.has(n);return GM_deleteValue(n),e}get(n){let e=GM_getValue(n,h);return e===h?void 0:e}has(n){return GM_getValue(n,h)!==h}keys(){return GM_listValues()}set(n,e){return GM_setValue(n,e),this}};function u(...t){M.enabled&&console.warn(...t)}function E(t,n){for(let e of t.keys()){let s=t.get(e),o=!0;if(n===-1)u(`purging value (forced): ${e}`);else if(typeof s.expires!="number"||typeof s.version!="string")u(`purging invalid value: ${e}:`,s);else if(n>s.expires){let r=new Date(s.expires).toLocaleString();u(`purging expired value: ${e} (${r})`)}else s.version!==C?u(`purging obsolete value: ${e} (${s.version})`):o=!1;o&&t.delete(e)}}function x(t,n,e={}){let s=e.context||document,o=typeof n;if(o==="function")return n.apply(s,e.args||[]);if(o==="string")return $(n,s);throw new TypeError(`invalid ${t} selector: expected string or function, got: ${o}`)}function B(t){let n=0;for(let e in t)n+=t[e]*(q[e]||0);return n*1e3}var P=t=>async function(e){let s=Date.now(),r=("cache"in e?!!e.cache:!0)?new m:new Map,b="dedup"in e?!e.dedup:!1,L=B(e.ttl||R),T=e.color||H,F=e.target||U,l=e.id||I,i=e.item,G=e.onHighlight||function(){};M.enabled="debug"in e?!!e.debug:!1;let f;if(typeof l=="function")f=(c,a)=>x("id",l,{context:c,args:a});else if(typeof l=="string")f=c=>t(c).attr(l);else throw new TypeError(`invalid ID selector: expected string or function, got: ${l}`);if(typeof i!="string"&&typeof i!="function")throw new TypeError(`invalid item selector: expected string or function, got: ${i}`);async function S(c){for(let a of c){let g=x("target",F,{context:a,args:[a]}),y=f(a,[g]),p=await A(y),v=r.has(p);if((!v||b)&&(g.css("background-color",T),g.addClass(w),G.call(a,g,{id:y,color:T})),!v){let D=s+L,N={expires:D,version:C},O=new Date(D).toLocaleString();u(`caching ${y} (${p}) until ${O}`),r.set(p,N)}}}GM_registerMenuCommand(k,()=>{E(r,-1)}),E(r,s);let _=t(document);if(_.onCreate&&typeof i=="string")_.onCreate(i,S,!0);else{let c=x("item",i);await S(c)}};jQuery.highlight=P(jQuery);jQuery.highlight.className=w;jQuery.highlight.selector="."+w;})();
